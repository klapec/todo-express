!function e(t,n,i){function a(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(r)return r(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return a(n?n:e)},d,d.exports,e,t,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=e("./model"),s=i(o),l=e("./view"),u=i(l),d=e("./controller"),c=i(d),f=new s["default"],m=new u["default"],k=new c["default"](f,m),v=function(){function e(){a(this,e),this.model=f,this.view=m,this.controller=k}return r(e,[{key:"init",value:function(){this.controller.bindAll()}}]),e}(),p=new v;p.init()},{"./controller":2,"./model":3,"./view":4}],2:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t,n){i(this,e),this.model=t,this.view=n}return a(e,[{key:"bindAll",value:function(){var e=this;this.view.taskList&&(this.view.bind("init"),this.view.bind("addTask",function(t){e.addTask(t.title)}),this.view.bind("editTask"),this.view.bind("editTaskDone",function(t){e.editTaskDone(t.id,t.title,t.oldVal)}),this.view.bind("editTaskCancel"),this.view.bind("removeTask",function(t){e.removeTask(t)}),this.view.bind("toggleTask",function(t){e.toggleTask(t.id,t.completed)}),this.view.bind("removeCompleted",function(t){e.removeTask(t)}))}},{key:"addTask",value:function(e){if(""!==e.trim()){var t=this;t.model.create(e,function(n){var i=JSON.parse(n);t.view.render("addTask",{err:i.err,id:i.id,title:e})})}}},{key:"editTaskDone",value:function(e,t,n){var i=this;t.trim()&&t!==n?i.model.update(e,{title:t},function(e){var t=JSON.parse(e);i.view.render("editTaskDone",{err:t.err,id:t.id,title:t.title})}):i.view.render("editTaskDone",{id:e,title:n})}},{key:"removeTask",value:function(e){var t=this,n="";e.completed?!function(){var t=[];Array.prototype.forEach.call(e.completed,function(e){t.push(e.dataset.id)}),n=t.join("&")}():n=e.id,t.model.remove(n,function(e){var n=JSON.parse(e);t.view.render("removeTask",{err:n.err,query:n.query})})}},{key:"toggleTask",value:function(e,t){var n=this;n.model.update(e,{completed:t},function(t){var i=JSON.parse(t);n.view.render("toggleTask",{err:i.err,id:e,completed:i.completed})})}}]),e}();n["default"]=r,t.exports=n["default"]},{}],3:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){i(this,e)}return a(e,[{key:"create",value:function(e,t){var n=new XMLHttpRequest;n.onload=function(){t(this.responseText)},n.open("post","/tasks",!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(JSON.stringify({title:e}))}},{key:"update",value:function(e,t,n){var i=new XMLHttpRequest;i.onload=function(){n(this.responseText)},i.open("put","/tasks/"+e,!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.send(JSON.stringify(t))}},{key:"remove",value:function(e,t){var n=new XMLHttpRequest;n.onload=function(){t(this.responseText)},n.open("delete","/tasks/"+e,!0),n.send()}}]),e}();n["default"]=r,t.exports=n["default"]},{}],4:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e,t){return(t||document).querySelector(e)},o=function(e,t){return(t||document).querySelectorAll(e)},s=function(e,t){for(var n=!0;n;){var i=e,a=t;if(n=!1,!i.parentNode)return!1;if(i.parentNode.tagName.toLowerCase()===a.toLowerCase())return i.parentNode;e=i.parentNode,t=a,n=!0}},l=function(e,t,n,i){"object"==typeof t?t.forEach(function(t){e.addEventListener(t,n,!!i)}):e.addEventListener(t,n,!!i)},u=function(e,t,n,i){function a(n){var a=n.target,r=o(t,e),s=Array.prototype.indexOf.call(r,a)>=0;s&&i.call(a,n)}var r="blur"===n||"focus"===n;l(e,n,a,r)},d=function(){function e(){i(this,e),this.ENTER_KEY=13,this.ESCAPE_KEY=27,this.addTaskInput=r(".add-task__name"),this.addTaskButton=r(".add-task__button"),this.taskList=r(".task-list"),this.taskListCounter=r(".task-counter"),this.taskListError=r(".task-list__error"),this.taskCounter=r(".task-counter"),this.clearCompleted=r(".clear-completed"),this.oldValCache=""}return a(e,[{key:"itemId",value:function(e){var t=s(e,"li");return t.dataset.id}},{key:"clearCompletedButton",value:function(e){this.clearCompleted.style.display=e?"block":"none"}},{key:"itemCounter",value:function(e){var t=o(".completed"),n=this.taskList.children.length-t.length,i=1===n?"":"s";return e?t:(this.clearCompletedButton(t.length),void(this.taskListCounter.textContent=n+" task"+i+" left"))}},{key:"displayError",value:function(){this.taskListError.style.display="block"}},{key:"bind",value:function(e,t){var n=this;"init"===e&&l(document,"DOMContentLoaded",function(){n.render("init")}),"addTask"===e&&(l(n.addTaskInput,"keypress",function(e){if(e.keyCode===n.ENTER_KEY){var i=this.value;t({title:i})}}),l(n.addTaskButton,["mouseup","keypress"],function(){var e=n.addTaskInput.value;t({title:e})})),"editTask"===e?u(n.taskList,".task-list__item__name","dblclick",function(){n.render("editTask",{id:n.itemId(this)})}):"editTaskDone"===e?(u(n.taskList,".task-list__item--edit","blur",function(){this.dataset.iscanceled||t({id:n.itemId(this),title:this.value,oldVal:n.oldValCache})}),u(n.taskList,".task-list__item--edit","keypress",function(e){e.keyCode===n.ENTER_KEY&&this.blur()})):"editTaskCancel"===e?u(n.taskList,".task-list__item--edit","keyup",function(e){e.keyCode===n.ESCAPE_KEY&&(this.dataset.iscanceled=!0,this.blur(),n.render("editTaskDone",{id:n.itemId(this),title:n.oldValCache}))}):"removeTask"===e?u(n.taskList,".task-list__item__delete","click",function(){t({id:n.itemId(this)})}):"toggleTask"===e?u(n.taskList,".task-list__item__toggle","click",function(){var e=void 0;-1!==this.className.search(/checked/)?(e=!1,this.className="task-list__item__toggle"):(e=!0,this.className+=" checked"),t({id:n.itemId(this),completed:e})}):"removeCompleted"===e&&l(n.clearCompleted,"click",function(){var e=n.itemCounter(!0);t({completed:e})})}},{key:"render",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{id:""}:arguments[1],n=this,i=r('[data-id="'+t.id+'"]');if(t.err)return n.displayError();var a={init:function(){n.itemCounter()},addTask:function(){n.addTaskInput.value="";var e=document.createElement("li");e.className="task-list__item",e.dataset.id=t.id;var i=document.createElement("div");i.className="task-list__item--view",e.appendChild(i);var a=document.createElement("span");a.className="task-list__item__toggle",i.appendChild(a);var r=document.createElement("label");r.className="task-list__item__name",r.textContent=t.title,i.appendChild(r);var o=document.createElement("button");o.className="task-list__item__delete",i.appendChild(o),n.taskList.appendChild(e),n.itemCounter()},editTask:function(){var e=document.createElement("input"),t=r("label",i).textContent;n.oldValCache=t,i.className=i.className+" editing",e.className="task-list__item--edit",i.appendChild(e),e.focus(),e.value=t},editTaskDone:function(){var e=r(".task-list__item--edit",i),n=r(".task-list__item__name",i);i.removeChild(e),i.className=i.className.replace("editing",""),n.textContent=t.title},removeTask:function(){return t.query.forEach(function(e){var t=r('[data-id="'+e+'"]');n.taskList.removeChild(t)}),n.itemCounter()},toggleTask:function(){i.className=t.completed?"task-list__item completed":"task-list__item",n.itemCounter()}};a[e]()}}]),e}();n["default"]=d,t.exports=n["default"]},{}]},{},[1]);